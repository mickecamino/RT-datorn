50 REM FR]N TIDNINGEN "ROM" APRIL 1978
60 REM TBL REV C 1980-10-26
100 PRINT "OTHELLO 1.5"
280 PRINT
290 PRINT "VILL DU HA INSTRUKTIONER (1=JA 2=NEJ)";
300 INPUT R
310 IF R=2 THEN 400
340 PRINT "F\R ATT SPELA MATA IN X,Y KOORDINATERNA"
350 PRINT "AV POSITIONEN DU VILL FLYTTA. OM DU"
360 PRINT "GER 99,9 SKRIVS BR[DET UT."
370 PRINT "X [R NED]T OCH Y HORISONTELLT"
380 PRINT
390 PRINT "OM DU GER 22,9 PRINTAS ALLA DINA TILLG[NGLIGA DRAG"
400 PRINT
405 REM
410 PRINT
420 DIM T(10,10),M(20,4), D(10,10)
430 DIM W(10,10),F(20,2),Z(7,2)
440 DIM G(4,8),O(8)
445 DIM V(10)
450 REM INTIERA BESLUTSMATRISEN 
460 GOSUB 1670
470 REM INITIERA BORDET
480 GOSUB 1930
490 F9=0
500 PRINT "VEM B\RJAR (1=DATORN 2 =MOTSPELAREN)";
510 INPUT R
520 PRINT "VILL DU HA BR[DET VISAT EFTER VARJE DRAG (1=JA 2=NEJ)";
530 INPUT Q9
570 IF Q9=1 THEN 590
580 GOSUB 2100
590 IF R=2 THEN 640
600 T(5,4)=1
610 T(5,5)=1
620 PRINT "DATORN DRAR :4,3"
630 PRINT "DATORN V[NDER :4,4"
640 PRINT
641 REM
642 PRINT
650 U1=2
660 U2=1
670 GOSUB 5140
680 IF P2=1 THEN 730
690 PRINT "DU HAR INGA GILTIGA DRAG"
700 IF F9=1 THEN 1430
710 F9=1
720 GO TO  1080
730 IF Q9=2 THEN 750
740 GOSUB 2100
750 PRINT "DU FLYTTAR";
760 INPUT M1,M2
770 IF M1<>99 THEN 800
780 GOSUB 2100
790 GO TO  750
800 IF M1<>22 THEN 890
810 PRINT "DINA  DRAG    ANTAL V[NDNINGAR"
820 FOR I=1 TO X
830 M1=M(I,1)-1
840 M2=M(I,2)-1
850 PRINT "      ";M1;",";M2;"    ";M(I,3)
860 NEXT I
870 PRINT
880 GO TO  750
890 M1=M1+1
900 M2=M2+1
910 F9=0
940 U1=2
950 U2=1
960 GOSUB 2500
970 IF P1=1 THEN 1000
980 PRINT "OTILL]TET DRAG...F\RS\K IGEN"
990 GO TO  640
1000 T(M1,M2)=2
1010 FOR I=1 TO L
1020 T(F(I,1),F(I,2))=2
1030 F(I,1)=F(I,1)-1
1040 F(I,2)=F(I,2)-1
1050 PRINT "    V[NDNINGAR :";F(I,1);",";F(I,2)
1060 NEXT I
1070 REM *** KOLLA SLUT AV SPEL
1080 GOSUB 2410
1090 IF P1=1 THEN 1430
1110 GOSUB 3700
1130 U1=1
1140 U2=2
1150 GOSUB 5140
1160 IF P2=1 THEN 1220
1170 PRINT "DATORN HAR INGA TILL]TNA DRAG"
1180 IF F9=1 THEN 1430
1190 F9=1
1200 GO TO  640
1220 GOSUB 5390
1230 F9=0
1260 U1=1
1270 U2=2
1280 GOSUB 2500
1290 T(M1,M2)=1
1300 M1=M1-1
1310 M2=M2-1
1320 PRINT "DATORN FLYTTAR : ";M1;",";M2
1330 FOR I=1 TO L
1340 T(F(I,1),F(I,2))=1
1350 F(I,1)=F(I,1)-1
1360 F(I,2)=F(I,2)-1
1370 PRINT "    V[NDNINGAR : ";F(I,1);",";F(I,2)
1380 NEXT I
1390 REM SLUT P] SPEL ?
1400 GOSUB 2410
1410 IF P1=0 THEN 640
1420 REM
1430 C1=0
1440 C2=0
1450 FOR I=2 TO 9
1460 FOR J=2 TO 9
1470 IF T(I,J)=1 THEN 1500
1480 IF T(I,J)=2 THEN 1520
1490 GO TO  1530
1500 C1=C1+1
1510 GO TO  1530
1520 C2=C2+1
1530 NEXT J
1540 NEXT I
1550 PRINT "*********** SPE  SLUT **********"
1560 PRINT
1570 PRINT "DATORN HAR ";C1;" PJ[SER, DU HAR ";C2;" PJ[SER"
1590 GOSUB 2100
1600 PRINT "SPELA IGEN (1=JA 2=NEJ) ";
1610 INPUT R
1620 IF R=1 THEN 480
1630 GO TO  6400
1650 REM ***SUBRUTINER
1670 REM ***INITIERA BESLUTSMATRISEN
1680 FOR I=1 TO 10
1690 FOR J=1 TO 10
1700 READ W(I,J)
1710 NEXT J
1720 NEXT I
1730 FOR I=1 TO 4
1740 FOR J=1 TO 8
1750 READ G(I,J)
1760 NEXT J
1770 NEXT I
1780 RETURN
1790 DATA 00,00,00,00,00,00,00,00,00,00
1800 DATA 00,10,00,09,09,09,09,00,10,00
1810 DATA 00,00,00,09,05,05,09,00,00,00
1820 DATA 00,09,09,07,07,07,07,09,09,00
1830 DATA 00,09,05,07,06,06,07,05,09,00
1840 DATA 00,09,05,07,06,06,07,05,09,00
1850 DATA 00,09,09,07,07,07,07,09,09,00
1860 DATA 00,00,00,09,05,05,09,00,00,00
1870 DATA 00,10,00,09,09,09,09,00,10,00
1880 DATA 00,00,00,00,00,00,00,00,00,00
1890 DATA 00,00,02,02,02,02,01,03
1900 DATA 00,00,02,02,02,01,03,03
1910 DATA 00,00,02,02,01,01,03,03
1920 DATA 00,00,02,01,01,01,03,03
1930 REM S]TT UPP BR]DET
1940 FOR I=2 TO 9
1950 FOR J=2 TO 9
1960 T(I,J)=0
1970 NEXT J
1980 NEXT I
1990 FOR I=1 TO 10
2000 T(I,1)=9
2010 T(I,10)=9
2020 T(1,I)=9
2030 T(10,I)=9
2040 NEXT I
2050 T(5,5)=2
2060 T(6,6)=2
2070 T(6,5)=1
2080 T(5,6)=1
2090 RETURN
2100 REM SKRIV UT BR]DET
2120 PRINT ".=BLANK, 1=DATORN, 2=DU"
2130 PRINT "    12345678"
2140 FOR I=2 TO 9
2150 I1=I-1
2160 PRINTI1;" ";
2170 FOR J=2 TO 9
2172 Y6=T(I,J)
2174 IF Y6=0 THEN PRINT ".";
2176 IF Y6=1 THEN PRINT "1";
2178 IF Y6=2 THEN PRINT "2";
2190 NEXT J
2200 PRINT
2210 NEXT I
2215 PRINT "    12345678"
2216 PRINT
2220 RETURN
2410 REM SLUT P] SPEL
2420 P1=0
2430 FOR I=2 TO 9
2440 FOR J=2 TO 9
2450 IF T(I,J)=0 THEN 2490
2460 NEXT J
2470 NEXT I
2480 P1=1
2490 RETURN
2500 REM ** [R DET ETT TILL]TET DRAG?
2510 P1=0
2520 L=0
2530 IF M1<2 THEN 2560
2540 IF M2<2 THEN 2560
2550 GO TO  2580
2560 P1=0
2570 RETURN
2580 IF M1>9 THEN 2610
2590 IF M2>9 THEN 2610
2600 GO TO  2630
2610 P1=0
2620 RETURN
2630 IF T(M1,M2)=0 THEN 2660
2640 P1=0
2650 RETURN
2660 IF T(M1+1,M2)<>U2 THEN 2770
2670 Q=0
2680 FOR I=M1+1 TO 9
2690 IF T(I,M2)=U1 THEN 2760
2700 IF T(I,M2)=0 THEN 2770
2710 Q=Q+1
2720 Z(Q,1)=I
2730 Z(Q,2)=M2
2740 NEXT I
2750 GO TO  2770
2760 GOSUB 3630
2770 IF T(M1+1,M2+1)<>U2 THEN 2890
2780 Q=0
2790 FOR I=1 TO 7
2800 IF T(M1+I,M2+I)=9 THEN 2890
2810 IF T(M1+I,M2+I)=0 THEN 2890
2820 IF T(M1+I,M2+I)=U1 THEN 2880
2830 Q=Q+1
2840 Z(Q,1)=M1+I
2850 Z(Q,2)=M2+I
2860 NEXT I
2870 GO TO  2890
2880 GOSUB 3630
2890 IF T(M1,M2+1)<>U2 THEN 3000
2900 Q=0
2910 FOR I=M2+1 TO 9
2920 IF T(M1,I)=U1 THEN 2990
2930 IF T(M1,I)=0 THEN 3000
2940 Q=Q+1
2950 Z(Q,1)=M1
2960 Z(Q,2)=I
2970 NEXT I
2980 GO TO  3000
2990 GOSUB 3630
3000 IF T(M1-1,M2-1)<>U2 THEN 3120
3010 Q=0
3020 FOR I=1 TO 7
3030 IF T(M1-I,M2-I)=9 THEN 3120
3040 IF T(M1-I,M2-I)=0 THEN 3120
3050 IF T(M1-I,M2-I)=U1 THEN 3110
3060 Q=Q+1
3070 Z(Q,1)=M1-I
3080 Z(Q,2)=M2-I
3090 NEXT I
3100 GO TO  3120
3110 GOSUB 3630
3120 IF T(M1-1,M2)<>U2 THEN 3240
3130 Q=0
3140 FOR I=1 TO 7
3150 IF T(M1-I,M2)=9 THEN 3240
3160 IF T(M1-I,M2)=0 THEN 3240
3170 IF T(M1-I,M2)=U1 THEN 3230
3180 Q=Q+1
3190 Z(I,1)=M1-I
3200 Z(I,2)=M2
3210 NEXT I
3220 GO TO  3240
3230 GOSUB 3630
3240 IF T(M1-1,M2+1)<>U2 THEN 3360
3250 Q=0
3260 FOR I=1 TO 7
3270 IF T(M1-I,M2+I)=9 THEN 3360
3280 IF T(M1-I,M2+I)=0 THEN 3360
3290 IF T(M1-I,M2+I)=U1 THEN 3350
3300 Q=Q+1
3310 Z(Q,1)=M1-I
3320 Z(Q,2)=M2+I
3330 NEXT I
3340 GO TO  3360
3350 GOSUB 3630
3360 IF T(M1,M2-1)<>U2 THEN 3480
3370 Q=0
3380 FOR I=1 TO 7
3390 IF T(M1,M2-I)=9 THEN 3480
3400 IF T(M1,M2-I)=0 THEN 3480
3410 IF T(M1,M2-I)=U1 THEN 3470
3420 Q=Q+1
3430 Z(Q,1)=M1
3440 Z(Q,2)=M2-I
3450 NEXT I
3460 GO TO  3480
3470 GOSUB 3630
3480 IF T(M1+1,M2-1)<>U2 THEN 3600
3490 Q=0
3500 FOR I=1 TO 7
3510 IF T(M1+I,M2-I)=9 THEN 3600
3520 IF T(M1+I,M2-I)=0 THEN 3600
3530 IF T(M1+I,M2-I)=U1 THEN 3590
3540 Q=Q+1
3550 Z(Q,1)=M1+I
3560 Z(Q,2)=M2-I
3570 NEXT I
3580 GO TO  3600
3590 GOSUB 3630
3600 IF L=0 THEN 3620
3610 P1=1
3620 RETURN
3630 REM **SHIFT RUTIN
3640 FOR Q2=1 TO Q
3650 L=L+1
3660 F(L,1)=Z(Q2,1)
3670 F(L,2)=Z(Q2,2)
3680 NEXT Q2
3690 RETURN
3700 REM **BER]KNA BESLUTS MATRISEN
3710 FOR I=1 TO 10
3720 FOR J=1 TO 10
3730 D(I,J)=W(I,J)
3740 NEXT J
3750 NEXT I
3760 IF T(2,2)<>1 THEN 3840
3770 D(2,3)=9
3780 D(3,2)=9
3790 D(3,3)=8
3800 D(4,4)=8
3810 D(5,5)=8
3820 D(6,6)=8
3830 D(7,7)=8
3840 IF T(2,9)<>1 THEN 3920
3850 D(2,8)=9
3860 D(3,9)=9
3870 D(3,8)=8
3880 D(4,7)=8
3890 D(5,6)=8
3900 D(6,5)=8
3910 D(7,4)=8
3920 IF T(9,2)<>1 THEN 4000
3930 D(8,2)=9
3940 D(9,3)=9
3950 D(8,3)=8
3960 D(7,4)=8
3970 D(6,5)=8
3980 D(5,6)=8
3990 D(4,7)=8
4000 IF T(9,9)<>1 THEN 4080
4010 D(9,8)=9
4020 D(8,9)=9
4030 D(8,8)=8
4040 D(7,7)=8
4050 D(6,6)=8
4060 D(5,5)=8
4070 D(4,4)=8
4080 IF T(2,2)<>2 THEN 4120
4090 D(2,3)=1
4100 D(3,2)=1
4110 D(3,3)=1
4120 IF T(2,9)<>2 THEN 4160
4130 D(2,8)=1
4140 D(3,8)=1
4150 D(3,9)=1
4160 IF T(9,9)<>2 THEN 4200
4170 D(8,9)=1
4180 D(8,7)=1
4190 D(9,8)=1
4200 IF T(9,2)<>2 THEN 4240
4210 D(8,2)=1
4220 D(8,3)=1
4230 D(9,3)=1
4240 IF T(2,4)<>1 THEN 4310
4250 IF T(3,3)<>2 THEN 4280
4260 IF T(2,2)=1 THEN 4280
4270 D(4,2)=1
4280 FOR I=3 TO 7
4290 D(I,4)=8
4300 NEXT I
4310 IF T(2,5)<>1 THEN 4350
4320 FOR I=3 TO 7
4330 D(I,5)=8
4340 NEXT I
4350 IF T(2,6)<>1 THEN 4390
4360 FOR I=3 TO 7
4370 D(I,6)=8
4380 NEXT I
4390 IF T(2,7)<>1 THEN 4460
4400 IF T(3,8)<>2 THEN 4430
4410 IF T(2,9)=1 THEN 4430
4420 D(4,9)=1
4430 FOR I=3 TO 7
4440 D(I,7)=8
4450 NEXT I
4460 IF T(4,2)<>1 THEN 4530
4470 IF T(3,3)<>2 THEN 4500
4480 IF T(2,2)=1 THEN 4500
4490 D(2,4)=1
4500 FOR I=3 TO 7
4510 D(4,I)=8
4520 NEXT I
4530 IF T(5,2)<>1 THEN 4570
4540 FOR I=3 TO 7
4550 D(5,I)=8
4560 NEXT I
4570 IF T(6,2)<>1 THEN 4610
4580 FOR I=3 TO 7
4590 D(6,I)=8
4600 NEXT I
4610 IF T(7,2)<>1 THEN 4680
4620 IF T(8,3)<>2 THEN 4650
4630 IF T(9,2)=1 THEN 4650
4640 D(9,4)=1
4650 FOR I=3 TO 7
4660 D(7,I)=8
4670 NEXT I
4680 IF T(9,4)<>1 THEN 4750
4690 IF T(8,3)<>2 THEN 4720
4700 IF T(9,2)=1 THEN 4720
4710 D(7,2)=1
4720 FOR I=1 TO 5
4730 D(9-I,4)=8
4740 NEXT I
4750 IF T(9,5)<>1 THEN 4790
4760 FOR I=1 TO 5
4770 D(9-I,5)=8
4780 NEXT I
4790 IF T(9,6)<>1 THEN 4830
4800 FOR I=1 TO 5
4810 D(9-I,6)=8
4820 NEXT I
4830 IF T(9,7)<>1 THEN 4900
4840 IF T(8,8)<>2 THEN 4870
4850 IF T(9,9)=1 THEN 4870
4860 D(7,9)=1
4870 FOR I=1 TO 5
4880 D(9-I,7)=8
4890 NEXT I
4900 IF T(7,9)<>1 THEN 4970
4910 IF T(8,8)<>2 THEN 4940
4920 IF T(9,9)=1 THEN 4940
4930 D(9,7)=1
4940 FOR I=1 TO 5
4950 D(7,9-I)=8
4960 NEXT I
4970 IF T(6,9)<>1 THEN 5010
4980 FOR I=1 TO 5
4990 D(6,9-I)=8
5000 NEXT I
5010 IF T(5,9)<>1 THEN 5050
5020 FOR I=1 TO 5
5030 D(5,9-I)=8
5040 NEXT I
5050 IF T(4,9)<>1 THEN 5120
5060 IF T(3,3)<>2 THEN 5090
5070 IF T(2,9)=1 THEN 5090
5080 D(2,7)=1
5090 FOR I=1 TO 5
5100 D(4,9-I)=8
5110 NEXT I
5120 GOSUB 5770
5130 RETURN
5140 REM FUNDERA UT TILL[TNA DRAG...DATORN
5150 X=0
5160 P2=0
5170 REM KOLLA HUR M[NGA AV SPELARENS PJ]SER P[ BR]DET
5180 Q7=0
5190 FOR M1=2 TO 9
5200 FOR M2=2 TO 9
5210 IF T(M1,M2)<>2 THEN 5230
5220 Q7=Q7+1
5230 NEXT M2
5240 NEXT M1
5250 FOR M1=2 TO 9
5260 FOR M2=2 TO 9
5270 GOSUB 2500
5280 IF P1=0 THEN 5360
5290 P2=1
5300 X=X+1
5310 M(X,1)=M1
5320 M(X,2)=M2
5330 M(X,3)=L
5340 IF L<>Q7 THEN 5360
5350 D(M1,M2)=11
5360 NEXT M2
5370 NEXT M1
5380 RETURN
5390 REM HITTA B]STA DRAG
5400 FOR I=1 TO X
5410 M(I,4)= D(M(I,1),M(I,2))
5420 NEXT I
5430 K2=4
5440 GOSUB 5570
5450 IF X=1 THEN 5540
5460 IF M(1,4)<>M(2,4) THEN 5540
5470 FOR I=1 TO X-1
5480 IF M(I,4)<>M(I+1,4) THEN 5510
5490 NEXT I
5500 GO TO  5520
5510 X=1
5520 K2=3
5530 GOSUB 5570
5540 M1=M(1,1)
5550 M2=M(1,2)
5560 RETURN
5570 REM ***SORTERA DRAGEN
5580 F=1
5590 FOR J=1 TO X
5600 IF F=0 THEN 5760
5610 F=0
5620 FOR I=1 TO X-1
5630 IF M(I,K2)>M(I+1,K2) THEN 5740
5640 F=1
5650 FOR K=1 TO 4
5660 V(K)=M(I,K)
5670 NEXT K
5680 FOR K=1 TO 4
5690 M(I,K)=M(I+1,K)
5700 NEXT K
5710 FOR K=1 TO 4
5720 M(I+1,K)=V(K)
5730 NEXT K
5740 NEXT I
5750 NEXT J
5760 RETURN
5770 FOR I=1 TO 8
5780 O(I)=T(2,I+1)
5790 NEXT I
5800 GOSUB 6270
5810 IF O1=1 THEN 5830
5820 D(2,3)=9
5830 FOR I=1 TO 8
5840 O(I)=T(2,10-I)
5850 NEXT I
5860 GOSUB 6270
5870 IF O1=1 THEN 5890
5880 D(2,8)=9
5890 FOR I=1 TO 8
5900 O(I)=T(I+1,2)
5910 NEXT I
5920 GOSUB 6270
5930 IF O1=1 THEN 5950
5940 D(3,2)=9
5950 FOR I=1 TO 8
5960 O(I)=T(10-I,2)
5970 NEXT I
5980 GOSUB 6270
5990 IF O1=1 THEN 6010
6000 D(8,2)=9
6010 FOR I=1 TO 8
6020 O(I)=T(9,I+1)
6030 NEXT I
6040 GOSUB 6270
6050 IF O1=1 THEN 6070
6060 D(9,3)=9
6070 FOR I=1 TO 8
6080 O(I)=T(9,10-I)
6090 NEXT I
6100 GOSUB 6270
6110 IF O1=1 THEN 6130
6120 D(9,8)=9
6130 FOR I=1 TO 8
6140 O(I)=T(I+1,9)
6150 NEXT I
6160 GOSUB 6270
6170 IF O1=1 THEN 6190
6180 D(3,9)=9
6190 FOR I=1 TO 8
6200 O(I)=T(10-I,9)
6210 NEXT I
6220 GOSUB 6270
6230 IF O1=1 THEN 6250
6240 D(8,9)=9
6250 RETURN
6260 REM: KOLLA M\NSTER G MOT ARRAY O
6270 FOR O2=1 TO 4
6280 FOR O3=1 TO 8
6290 IF G(O2,O3)=3 THEN 6340
6300 IF G(O2,O3)=O(O3) THEN 6340
6310 GO TO 6370
6320 IF O(O3)<>2 THEN 6340
6330 GO TO  6370
6340 NEXT O3
6350 O1=0
6360 RETURN
6370 NEXT O2
6380 O1=1
6390 RETURN
6400 END
