10 REM A=TABELL \VER ALLA SPELARES KORT
20 REM M=V[XEL SOM ANGER OM PASS ELLER SPEL SPELAS
30 REM N ANGER VAL\R P] KORT
40 REM O INNEH]LLER NUMMER P] SPELAREN VARS KORT [R H\GST
50 REM P ANGER F[RG P] RT OM EJ R[TT F[RG FINNS
60 REM S ANGER F[RG P] SPELAT KORT
70 REM W=V[XEL SOM ANGER OM MEDSPELAREN HAR DRAGIT
80 PRINT CHR$(5)
85 PRINT
90 PRINT"DETTA [R 4-MANS WHIST,KAN DU SPELA DET";
100 INPUT Q$
110 IF Q$="JA" THEN 210
120 IF Q$="NEJ" THEN 160
130 PRINT
140 PRINT"SVARA BARA JA ELLER NEJ,TACK"
150 GOTO 100
160 PRINT
170 PRINT"DET VAR ILLA - D] M]STE DU L[RA DIG"
180 PRINT
190 PRINT"LYCKA TILL"
200 GOTO 2280
210 DIM A(4,13),B$(4),C$(13),E(6),K$(2),L$(4),V(2,4),W(4)
212 PRINT
213 PRINT"DR\J N]GON MINUT......"
214 PRINT"JAG DELAR SAKTA......."
220 FOR I=1 TO 4
230 READ B$(I)
240 DATA "HJ[RTER","RUTER","KL\VER","SPADER"
250 NEXT I
260 FOR I=1 TO 4
270 W(I)=0
280 NEXT I
290 FOR I=1 TO 13
300 READ C$(I)
310 DATA "TV]","TRE","FYRA","FEM","SEX",SJU"
320 DATA "]TTA","NIO","TIO","KNEKT","DAM","KUNG","ESS"
330 NEXT I
340 FOR I=1 TO 2
350 READ K$(I)
360 DATA "PASS","SPEL"
370 NEXT I
380 FOR I=1 TO 4
390 READ L$(I)
400 DATA "DU","SPELARE 1","JAG DATORN","SPELARE 2"
410 NEXT I
420 FOR I=1 TO 4
430 FOR J=1 TO 13
440 A(I,J)=0
450 NEXT J
460 NEXT I
470 FOR I=1 TO 4
480 E(I)=1
490 NEXT I
500 FOR X=1 TO 13
510 FOR Y=1 TO 13
520 GOSUB 2290
530 A(I,J)=Y
540 NEXT Y
550 NEXT X
552 FOR I=1 TO 4
554 FOR J=1 TO 13
556 IF A(I,J)=0 THEN A(I,J)=4
558 NEXT J
559 NEXT I
560 PRINT
570 PRINT
580 PRINT"OK,D] B\RJAR VI. KORTEN [R UTDELADE."
590 F=0
600 GOSUB 2340
610 FOR F=2 TO 4
620 G=0
630 GOSUB 2510
640 IF G>4 THEN E(F)=2
650 NEXT F
660 PRINT
670 PRINT"VAD V[LJER DU,PASS ELLER SPEL";
680 INPUT H$
690 IF H$=K$(1) THEN 720
700 IF H$<>K$(2) THEN 670
710 E(1)=2
720 REM DAGS ATT PRINTA SPELPLAN
730 PRINT "  "
740 FOR I=1 TO 5
750 PRINT
760 NEXT I
770 PRINT "     ";L$(3);" VALDE ";K$(E(3))
780 FOR I=1 TO 5
790 PRINT
800 NEXT I
810 PRINT L$(2);"-";K$(E(2));"  ";L$(4);"-";K$(E(4))
820 FOR I=1 TO 5
830 PRINT
840 NEXT I
850 PRINT "    ";L$(1);" VALDE ";K$(E(1))
860 FOR I=1 TO4
870 PRINT
880 NEXT I
890 M=0
900 FOR I=1 TO 4
910 IF E(I)=1 THEN 940
920 M=I
930 GOTO 960
940 NEXT I
950 IF M=0 THEN 1000
960 PRINT L$(I);" VALDE ";K$(2)
970 I=I-1
980 IF I=0 THEN I=4
990 GOTO 1020
1000 PRINT "ALLA VALDE ";K$(1)
1010 I=1
1020 PRINT "DET BETYDER ATT ";L$(I);" B\RJAR"
1030 PRINT
1040 PRINT "[R DU KLAR";
1050 INPUT Q$
1060 IF Q$<>"JA" THEN 1040
1070 T=T+1
1080 PRINT
1090 ON I GOTO 1100,1270,1390,1540
1100 F=0
1110 GOSUB 2340
1120 GOSUB 3320
1130 IF W(1)=1 THEN 1170
1140 IF M=0 THEN V(1,1)=I
1150 IF M>0 THEN V(2,1)=I
1160 W(1)=1
1170 S=X
1180 O=1
1190 I=1
1200 GOSUB 3600
1210 Y=J
1220 FOR I=2 TO 4
1230 GOSUB 4240
1240 GOSUB 3600
1250 NEXT I
1260 GOTO 1680
1270 O=2
1280 GOSUB 3800
1290 FOR I=2 TO 4
1300 GOSUB 4240
1310 GOSUB 3600
1320 NEXT I
1330 GOSUB 4150
1340 GOSUB 4090
1350 GOSUB 2340
1360 GOSUB 3320
1370 GOSUB 3690
1380 GOTO 1980
1390 O=3
1400 GOSUB 3800
1410 FOR I=3 TO 4
1420 GOSUB 4240
1430 GOSUB 3600
1440 NEXT I
1450 GOSUB 4150
1460 GOSUB 4090
1470 GOSUB 2340
1480 GOSUB 3320
1490 GOSUB 3690
1500 I=2
1510 GOSUB 4240
1520 GOSUB 3600
1530 GOTO 1680
1540 O=4
1550 GOSUB 3800
1560 I=4
1570 GOSUB 4240
1580 GOSUB 3600
1590 GOSUB 4150
1600 GOSUB 4090
1610 GOSUB 2340
1620 GOSUB 3320
1630 GOSUB 3690
1640 FOR I=2 TO 3
1650 GOSUB 4240
1660 GOSUB 3600
1670 NEXT I
1680 PRINT
1690 PRINT
1700 PRINT L$(0);" TOG STICKET"
1710 PRINT
1720 PRINT
1730 PRINT
1740 ON O GOTO 1770,1750,1770,1750
1750 E(6)=E(6)+1
1760 GOTO 1780
1770 E(5)=E(5)+1
1780 I=O
1790 IF T=13 THEN 1850
1800 PRINT
1810 PRINT "VI HAR ";E(5);"     DOM HAR ";E(6)
1815 PRINT
1820 PRINT "DAGS F\R N[STA - SKRIN N N[R DU [R KLAR"
1830 INPUT Q$
1835 PRINT CHR$(5)
1840 GOTO 1070
1850 PRINT
1860 PRINT
1870 PRINT
1880 PRINT "JAHA, D] SKALL VI SE..."
1890 PRINT
1900 PRINT L$(1);" OCH ";L$(3);" FICK ";" STICK OCH ";
1905 PRINT
1910 PRINT L$(2);" OCH ";L$(4);"  ";E(6);" STICK"
1930 PRINT
1940 T=E(6) - E(5)
1950 IF M>O THEN 2050
1960 PRINT
1970 PRINT "ALLA VALDE ";K$(1)
1980 IF T>O THEN 2020
1990 I=2
2000 J=4
2010 GOTO 2210
2020 I=1
2030 J=3
2040 GOTO 2210
2050 IF T>O THEN 2160
2060 IF M=1 THEN 2080
2070 IF M<>3 THEN 2130
2080 PRINT
2090 PRINT L$(M);" VALDE ";K$(2)
2100 IF M=1 THEN 2020
2110 IF M=3 THEN 2020
2120 GOTO 1990
2130 PRINT
2140 PRINT "BRAVO!! NI TOG STRAFF P] DOM.."
2150 GOTO 2020
2160 IF M=2 THEN 2080
2170 IF M=4 THEN 2080
2180 PRINT
2190 PRINT"AJ AJ,DET GICK INGET VIDARE DET D[R,BARA ";E(5);" STICK"
2200 GOTO 1990
2210 PRINT
2220 PRINT "OCH DET BETYDER ATT ";L$(I);" OCH ";L$(J);" HAR VUNNIT"
2230 PRINT
2240 PRINT "VILL DU PR\VA LYCKAN IGEN";
2250 INPUT Q$
2260 IF Q$="JA" THEN 420
2270 IF Q$<>"NEJ" THEN 2240
2280 END
2290 REM SUBRUTIN SOM F\\RDELAR KORTEN
2300 I=INT(RND(0 )*4)+1
2310 J=INT(RND(0 )*13)+1
2320 IF A(I,J)>0 THEN 2300 
2330 RETURN
2340 REM SUBRUTIN SOM LISTAR SPELARENS KORT
2350 PRINT "  "
2360 PRINT "DU HAR :"
2370 IF F=0 THEN 2400 
2380 I=F
2390 GOTO 2410 
2400 FOR I=1 TO 4
2410 PRINT "  "
2420 D$=B$(I)
2430 FOR J=1 TO 13
2440 IF A(I,J)<>1 THEN 2470 
2450 PRINT D$,C$(J)
2460 D$="   "
2470 NEXT J
2480 IF F<>0 THEN 2500 
2490 NEXT I
2500 RETURN
2510 REM SUBRUTIN SOM V[LJER PASS ELLER SPEL HOS \VRIGA SPELARE
2520 Y=0 
2530 FOR I=1 TO 4
2540 X=0 
2550 FOR J=11 TO 13
2560 IF A(I,J)<>F THEN 2590 
2570 G=G+1
2580 X=X+1
2590 NEXT J
2600 IF X<Y THEN 2630 
2610 V(2,F)=I
2620 Y=X
2630 NEXT I
2640 Y=0 
2650 FOR I=1 TO 4
2660 X=0 
2670 FOR J=4 TO 1 STEP-1
2680 IF A(I,J)=F THEN X=X+1
2690 NEXT J
2700 IF X<Y THEN 2730 
2710 Y=X
2720 V(1,F)=I
2730 NEXT I
2740 IF V(1,F)=0 THEN S=INT(RND(0 )*4)+1
2750 IF V(2,F)=0 THEN S=INT(RND(0 )*4)+1
2760 RETURN
2770 REM SUBRUTIN SOM SPELAR F\RDELAKTIGASTE KORT VID SPEL
2780 REM I=AKTUELL SPELARE
2790 FOR J=1 TO 13
2800 IF A(S,J)<>I THEN 2860 
2810 IF J<Y THEN 2860 
2820 A(S,J)=0 
2830 Y=J
2840 O=I
2850 GOTO 3040 
2860 NEXT J
2870 REM INGET H\GRE KORT
2880 FOR J=1 TO 13
2890 IF A(S,J)<>I THEN 2920 
2900 A(S,J)=0 
2910 GOTO 3040 
2920 NEXT J
2930 REM INGET KORT I R[TT F[RG
2940 FOR P=1 TO 4
2950 FOR J=1 TO 13
2960 IF A(P,J)<>I THEN 3020 
2970 IF E(I)=2 THEN 3000 
2980 IF T>9 THEN 3000 
2990 IF J>10 THEN 3020 
3000 A(P,J)=0 
3010 GOTO 3040 
3020 NEXT J
3030 NEXT P
3040 N=J
3050 RETURN
3060 REM SUBRUTIN SOM SPELAR F\RDELAKTIGASTE KORT VID PASS
3070 REM I=AKTUELL SPELARE
3080 FOR J=13 TO 1 STEP-1
3090 IF A(S,J)<>I THEN 3130 
3100 IF J>Y THEN 3130 
3110 A(S,J)=0 
3120 GOTO  3300 
3130 NEXT J
3140 REM
3150 FOR J=1 TO 13
3160 IF A(S,J)<>I THEN 3210 
3170 A(S,J)=0 
3180 Y=J
3190 O=I
3200 GOTO 3300 
3210 NEXT J
3220 REM
3230 FOR P=1 TO 4
3240 FOR J=13 TO 1 STEP-1
3250 IF A(P,J)<>I THEN 3280 
3260 A(P,J)=0 
3270 GOTO 3300 
3280 NEXT J
3290 NEXT P
3300 N=J
3310 RETURN
3320 REM SUBRUTIN SOM KONTROLLERAR SLAGET KORT
3330 PRINT 
3340 IF F=0 THEN 3370 
3350 PRINT "ANGE BARA VAL\R P] KORT"
3360 GOTO 3410 
3370 PRINT "ANGE F\RST F[RG, SEDAN VAL\R"
3373 PRINT 
3375 PRINT "EXEMPEL  HJ[RTER,FEM ( GL\M INTE KOMMAT)"
3380 PRINT 
3390 PRINT "VILKET KORT V[LJER DU";
3400 INPUT Q$,R$
3405 GOTO 3420 
3410 INPUT R$
3415 PRINT 
3420 FOR I=1 TO 4
3430 IF B$(I)<>Q$ THEN 3500
3440 FOR J=1 TO 13
3450 IF C$(J)<>R$ THEN 3490 
3460 IF A(I,J)=1 THEN 3560 
3470 PRINT "DET KORTET HAR DU INTE"
3480 GOTO 3520 
3490 NEXT J
3500 NEXT I
3510 PRINT "DET KORTET K[NNER JAG INTE TILL"
3520 PRINT 
3530 PRINT "F\RS\K IGEN"
3540 GOSUB 2340 
3550 GOTO 3330 
3560 A(I,J)=0 
3570 X=I
3580 N=J
3590 RETURN
3600 REM SUBRUTIN SOM SKRIVER UT SLAGET KORT
3610 IF P<>0 THEN 3650 
3620 PRINT L$(I),"SL]R ";B$(S),C$(N)
3630 PRINT 
3640 GOTO  3680 
3650 PRINT L$(I),"SAKAR ";B$(P),C$(N)
3660 PRINT 
3670 P=0 
3680 RETURN
3690 REM SUBRUTIN SOM TOLKAR DITT KORT
3700 IF X<>S THEN 3760 
3710 IF J<Y THEN 3740 
3720 Y=J
3730 O=1
3740 P=0 
3750 GOTO 3770 
3760 P=X
3770 I=1
3780 GOSUB 3600 
3790 RETURN
3800 REM SUBRUTIN SOM V[LJER F[RG
3810 Y=0 
3820 IF M=0 THEN J=1
3830 IF M>0 THEN J=2
3840 IF O=3 THEN 3890 
3850 IF O=4 THEN 3920 
3860 IF W(4)=0 THEN 3950 
3870 S=V(J,4)
3880 GOTO 4030 
3890 IF W(1)=0 THEN 3950 
3900 S=V(J,1)
3910 GOTO 4030 
3920 IF W(2)=0 THEN 3950 
3930 S=V(J,2)
3940 GOTO 4030 
3950 S=V(J,O)
3960 W(O)=1
3970 GOTO 3990 
3980 S=INT(RND(0 )*4)+1
3990 FOR I=1 TO 13
4000 IF A(S,I)=O THEN 40 70 
4010 NEXT I
4020 GOTO 3980 
4030 FOR I=1 TO 13
4040 IF A(S,I)=O THEN 4070 
4050 NEXT I
4060 GOTO 3950 
4070 X=S
4080 RETURN
4090 REM SUBRUTIN SOM STANNAR PROGRAMMET
4100 IF F<>0 THEN 4140 
4110 PRINT "SKRIV N N[R DU [R KLAR"
4120 INPUT Q$
4130 PRINT 
4140 RETURN
4150 REM SUBRUTIN SOM TESTAR OM KORT FINNS I R[TT F[RG
4160 FOR J=1 TO 13
4170 IF A(S,J)<>1 THEN 4210 
4180 F=S
4190 Q$=B$(S)
4200 GOTO 4230 
4210 NEXT J
4220 F=0 
4230 RETURN
4240 REM SUBRUTIN SOM V[LJER PASS ELLER SPEL SUBRUTIN
4250 IF M>0 THEN GOSUB 2770 
4260 IF M=0 THEN GOSUB 3060 
4270 RETURN
